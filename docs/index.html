<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ER Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <h1>ER Diagram</h1>
    <div class="mermaid">
    erDiagram
        USER ||--|{ ACCOUNT : "owns"

    
        USER {
            int id PK
            string username
            string password
            datetime created_at
            boolean is_admin
        }
    
        ACCOUNT {
            int id PK
            string name
            string account_number
            float balance
            string currency
            string status
            datetime created_at
            string country
            int user_id FK
        }
    
        TRANSACTION {
            int id PK
            float amount
            datetime timestamp
            int sender_account_id FK
            int receiver_account_id FK
        }
    
        TRANSACTION }o--|| ACCOUNT : "sender_account"
        TRANSACTION }o--|| ACCOUNT : "receiver_account"
    </div>

    <h1>Data Flow Diagram</h1>
    <div class="mermaid">
    flowchart TD
        
        %% External Entities
        User[[User]]
        Admin[[Admin]]
        
        %% Processes
        AuthenticateUser([Authenticate User])
        ManageAccounts([Manage Accounts])
        ManageTransactions([Manage Transactions])
        
        %% Data Stores
        UserTable[(User Table)]
        AccountTable[(Account Table)]
        TransactionTable[(Transaction Table)]
        
        %% Data Flows
        
        %% User Authentication
        User -->|Credentials| AuthenticateUser
        AuthenticateUser -->|User Data| UserTable
        AuthenticateUser -->|Authentication Result| User
        
        %% Account Management
        User -->|Account Requests : Create,Edit,Delete,| ManageAccounts
        ManageAccounts -->|Account Data| AccountTable
        ManageAccounts -->|Account Info| User
        
        %% Transaction Management
        User -->|Transaction Requests: Create, Transfer| ManageTransactions
        ManageTransactions -->|Transaction Data| TransactionTable
        ManageTransactions -->|Transaction Confirmation| User
        
        %% Account Balance Update
        ManageTransactions -->|Update Balance| AccountTable
        
        %% Admin Interactions
        Admin -->|Manage Users: Create, Delete| ManageAccounts
        Admin -->|View/Edit Transactions| ManageTransactions
    </div>
        
    <h1>Use Case Diagram (Registration)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant User
            participant WebApp
            participant Database

            User->>WebApp: Open Registration Page
            User->>WebApp: Submit Registration Form
            WebApp->>Database: Check if Username Exists
            Database-->>WebApp: Username Available
            WebApp->>Database: Save New User Details
            Database-->>WebApp: Confirmation
            WebApp->>User: Registration Successful

    </div>  
    
    <h1>Use Case Diagram (Login)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant User
            participant WebApp
            participant Database

            User->>WebApp: Enter Credentials
            WebApp->>Database: Retrieve User by Username
            Database-->>WebApp: Return User Data
            WebApp->>WebApp: Verify Password
            alt Password Correct
                WebApp->>User: Login Successful
            else Password Incorrect
                WebApp->>User: Login Failed
            end
    </div>

    <h1>Use Case Diagram (Deposit Funds)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant User
            participant WebApp
            participant Database

            User->>WebApp: Initiate Deposit
            WebApp->>Database: Retrieve Account Details
            Database-->>WebApp: Account Data
            WebApp->>Database: Update Account Balance
            Database-->>WebApp: Update Confirmation
            WebApp->>User: Deposit Successful
    </div>

    <h1>Use Case Diagram (Transfer Funds)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant User
            participant WebApp
            participant Database

            User->>WebApp: Initiate Transfer (Amount, Receiver Account)
            WebApp->>Database: Retrieve Sender Account
            WebApp->>Database: Retrieve Receiver Account
            WebApp->>WebApp: Validate Accounts and Balance
            alt Validation Successful
                WebApp->>Database: Deduct Amount from Sender
                WebApp->>Database: Add Amount to Receiver
                WebApp->>Database: Record Transaction
                Database-->>WebApp: Transaction Recorded
                WebApp->>User: Transfer Successful
            else Validation Fails
                WebApp->>User: Transfer Failed
            end
    </div>

    <h1>Use Case Diagram (Withdraw Funds)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant User
            participant WebApp
            participant Database

            User->>WebApp: Initiate Withdrawal (Amount)
            WebApp->>Database: Retrieve User Account Details
            Database-->>WebApp: Return Account Data
            WebApp->>WebApp: Validate Withdrawal Amount
            alt Sufficient Funds
                WebApp->>Database: Deduct Amount from Account Balance
                Database-->>WebApp: Update Confirmation
                WebApp->>Database: Record Withdrawal Transaction
                Database-->>WebApp: Transaction Recorded
                WebApp->>User: Withdrawal Successful
            else Insufficient Funds
                WebApp->>User: Withdrawal Failed - Insufficient Funds
            end
    </div>

    <h1>Use Case Diagram (Admin changes user account to admin)</h1>
    <div class="mermaid">
        sequenceDiagram
            participant Admin
            participant WebApp
            participant Database

            Admin->>WebApp: Request to Promote User to Admin (User ID)
            WebApp->>Database: Retrieve User Details by ID
            Database-->>WebApp: Return User Data
            WebApp->>WebApp: Validate Admin Privileges
            alt Authorized
                WebApp->>Database: Update User's is_admin to True
                Database-->>WebApp: Update Confirmation
                WebApp->>Database: Log Admin Promotion Transaction
                Database-->>WebApp: Transaction Recorded
                WebApp->>Admin: User Promoted to Admin Successfully
            else Unauthorized
                WebApp->>Admin: Promotion Failed - Unauthorized Action
            end
    </div>
        
</body>
</html>
